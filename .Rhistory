scale_color_hue(name='Northeast States')+
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(expand=c(0,1), breaks=seq(-60,60,5), limits=c(0,30),
labels=as.character(seq(-60,60,5)))+
ylab("Unemployment Rate") +
xlab("Month") +
ggtitle("2020 Unemployment Rate in Northeast US") +
theme_minimal() +
theme(axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
unemploy.s <- unemployment_South %>%
mutate(month = as.Date(paste("2020-", month,"-01", sep=""))) %>%
ggplot(aes(x = month, y = unemployment.rate.2020, color = state)) +
geom_line() +
geom_point() +
scale_color_hue(name='South States')+
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(expand=c(0,1), breaks=seq(-60,60,5), limits=c(0,30),
labels=as.character(seq(-60,60,5)))+
ylab("Unemployment Rate") +
xlab("Month") +
ggtitle("2020 Unemployment Rate in South US") +
theme_minimal() +
theme(axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
unemploy.w <- unemployment_West %>%
mutate(month = as.Date(paste("2020-", month,"-01", sep=""))) %>%
ggplot(aes(x = month, y = unemployment.rate.2020, color = state)) +
geom_line() +
geom_point() +
scale_color_hue(name='West States')+
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(expand=c(0,1), breaks=seq(-60,60,5), limits=c(0,30),
labels=as.character(seq(-60,60,5)))+
ylab("Unemployment Rate") +
xlab("Month") +
ggtitle("2020 Unemployment Rate in West US") +
theme_minimal() +
theme(axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
South.states.1 <- c("West Virginia","Oklahoma","Kentucky","Alabama","Arkansas","Tennessee","Louisiana","Mississippi","South Carolina","Texas","Georgia","North Carolina","Florida","Virginia","Delaware","Maryland","District Of Columbia")
# made adjustment for DC spelling difference
svi.state_Midwest <- filter(svi.state, STATE %in% Midwest.states)
svi.state_Northeast <- filter(svi.state, STATE %in% Northeast.states)
svi.state_South <- filter(svi.state, STATE %in% South.states.1)
svi.state_West <- filter(svi.state, STATE %in% West.states)
svi.pov.mw <- svi.state_Midwest %>%
ggplot(aes(x = reorder(STATE, poverty.rate), y = poverty.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.21) +
xlab("State") +
ylab("Poverty Rate") +
ggtitle("Poverty Rate in Midwest US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.pov.ne <- svi.state_Northeast %>%
ggplot(aes(x = reorder(STATE, poverty.rate), y = poverty.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.21) +
xlab("State") +
ylab("Poverty Rate") +
ggtitle("Poverty Rate in Northeast US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.pov.s <- svi.state_South %>%
ggplot(aes(x = reorder(STATE, poverty.rate), y = poverty.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.21) +
xlab("State") +
ylab("Poverty Rate") +
ggtitle("Poverty Rate in South US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.pov.w <- svi.state_West %>%
ggplot(aes(x = reorder(STATE, poverty.rate), y = poverty.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(x=13, y =0.042, label = "New Mexico data missing",
size = 5, color = "black")+
ylim(0, 0.21) +
xlab("State") +
ylab("Poverty Rate") +
ggtitle("Poverty Rate in South US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
### New Mexico data missing
svi.uninsured.mw <- svi.state_Midwest %>%
ggplot(aes(x = reorder(STATE, uninsured.rate), y = uninsured.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.175) +
xlab("State") +
ylab("Uninsured  Rate") +
ggtitle("Uninsured Rate in Midwest US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.uninsured.ne <- svi.state_Northeast %>%
ggplot(aes(x = reorder(STATE, uninsured.rate), y = uninsured.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.175) +
xlab("State") +
ylab("Uninsured  Rate") +
ggtitle("Uninsured Rate in Northeast US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.uninsured.s <- svi.state_South %>%
ggplot(aes(x = reorder(STATE, uninsured.rate), y = uninsured.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.175) +
xlab("State") +
ylab("Uninsured  Rate") +
ggtitle("Uninsured Rate in South US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.uninsured.w <- svi.state_West %>%
ggplot(aes(x = reorder(STATE, uninsured.rate), y = uninsured.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.175) +
xlab("State") +
ylab("Uninsured  Rate") +
ggtitle("Uninsured Rate in West US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.mobile.mw <- svi.state_Midwest %>%
ggplot(aes(x = reorder(STATE, mobile.home.rate), y = mobile.home.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.08) +
xlab("State") +
ylab("Mobile Home Rate") +
ggtitle("Mobile Home Rate in Midwest US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.mobile.ne <- svi.state_Northeast %>%
ggplot(aes(x = reorder(STATE, mobile.home.rate), y = mobile.home.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.08) +
xlab("State") +
ylab("Mobile Home Rate") +
ggtitle("Mobile Home Rate in Northeast US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.mobile.s <- svi.state_South %>%
ggplot(aes(x = reorder(STATE, mobile.home.rate), y = mobile.home.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.08) +
xlab("State") +
ylab("Mobile Home Rate") +
ggtitle("Mobile Home Rate in South US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.mobile.w <- svi.state_West %>%
ggplot(aes(x = reorder(STATE, mobile.home.rate), y = mobile.home.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.08) +
xlab("State") +
ylab("Mobile Home Rate") +
ggtitle("Mobile Home Rate in West US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.minority.mw <- svi.state_Midwest %>%
ggplot(aes(x = reorder(STATE, minority.rate), y = minority.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.8) +
xlab("State") +
ylab("Minority Rate") +
ggtitle("Minority Rate in Midwest US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.minority.ne <- svi.state_Northeast %>%
ggplot(aes(x = reorder(STATE, minority.rate), y = minority.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.8) +
xlab("State") +
ylab("Minority Rate") +
ggtitle("Minority Rate in Northeast US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.minority.s <- svi.state_South %>%
ggplot(aes(x = reorder(STATE, minority.rate), y = minority.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.8) +
xlab("State") +
ylab("Minority Rate") +
ggtitle("Minority Rate in South US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.minority.w <- svi.state_West %>%
ggplot(aes(x = reorder(STATE, minority.rate), y = minority.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.8) +
xlab("State") +
ylab("Minority Rate") +
ggtitle("Minority Rate in West US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.disabled.mw <- svi.state_Midwest %>%
ggplot(aes(x = reorder(STATE, disabled.rate), y = disabled.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.2) +
xlab("State") +
ylab("Disabled Rate") +
ggtitle("Disabled Rate in Midwest US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.disabled.ne <- svi.state_Northeast %>%
ggplot(aes(x = reorder(STATE, disabled.rate), y = disabled.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.2) +
xlab("State") +
ylab("Disabled Rate") +
ggtitle("Disabled Rate in Northeast US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.disabled.s <- svi.state_South %>%
ggplot(aes(x = reorder(STATE, disabled.rate), y = disabled.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.2) +
xlab("State") +
ylab("Disabled Rate") +
ggtitle("Disabled Rate in South US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.disabled.w <- svi.state_West %>%
ggplot(aes(x = reorder(STATE, disabled.rate), y = disabled.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.2) +
xlab("State") +
ylab("Disabled Rate") +
ggtitle("Disabled Rate in West US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.old.mw <- svi.state_Midwest %>%
ggplot(aes(x = reorder(STATE, age65.rate), y = age65.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.2) +
xlab("State") +
ylab("Age over 65 Rate") +
ggtitle("Age over 65 Rate in Midwest US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.old.ne <- svi.state_Northeast %>%
ggplot(aes(x = reorder(STATE, age65.rate), y = age65.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.2) +
xlab("State") +
ylab("Age over 65 Rate") +
ggtitle("Age over 65 Rate in Northeast US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.old.s <- svi.state_South %>%
ggplot(aes(x = reorder(STATE, age65.rate), y = age65.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.2) +
xlab("State") +
ylab("Age over 65 Rate") +
ggtitle("Age over 65 Rate in South US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.old.w <- svi.state_West %>%
ggplot(aes(x = reorder(STATE, age65.rate), y = age65.rate, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 0.2) +
xlab("State") +
ylab("Age over 65 Rate") +
ggtitle("Age over 65 Rate in West US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.pci.mw <- svi.state_Midwest %>%
ggplot(aes(x = reorder(STATE, per.capita), y = per.capita, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 55000) +
xlab("State") +
ylab("Per Capita Income") +
ggtitle("Per Capita Income in Midwest US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.pci.ne <- svi.state_Northeast %>%
ggplot(aes(x = reorder(STATE, per.capita), y = per.capita, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 55000) +
xlab("State") +
ylab("Per Capita Income") +
ggtitle("Per Capita Income in Northeast US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.pci.s <- svi.state_South %>%
ggplot(aes(x = reorder(STATE, per.capita), y = per.capita, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
ylim(0, 55000) +
xlab("State") +
ylab("Per Capita Income") +
ggtitle("Per Capita Income in South US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
svi.pci.w <- svi.state_West %>%
ggplot(aes(x = reorder(STATE, per.capita), y = per.capita, color = STATE, fill = STATE)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(x=13, y =10800, label = "New Mexico data missing",
size = 5, color = "black")+
ylim(0, 55000) +
xlab("State") +
ylab("Per Capita Income") +
ggtitle("Per Capita Income in West US") +
theme_minimal() +
theme(legend.position = 'none', # remove legend,
axis.title = element_text(size=12), # change axis style
legend.title = element_text(size=12), # change legend style
plot.title = element_text(size=14)) # change title style
### New Mexico data missing
svi.analysis <- svi.state %>%
select(c(STATE, poverty.rate, per.capita, no.HS.rate, age65.rate, disabled.rate, minority.rate, uninsured.rate)) %>%
mutate(state = STATE)
covid.mortality <- covid.time.series %>%
filter(date == as.Date("2020-10-24")) %>%
mutate(mortality.avg = (cumulative.death.cases / cumulative.confirmed.cases)*100) %>%
select(state, mortality.avg)
svi.mortality <- svi.analysis %>%
inner_join(covid.mortality, by = "state") %>%
select(-state)
covid.active <- covid.time.series %>%
select(c(state, date, active.rates)) %>%
mutate(lag.active.rates = date - 5)
mobility.active <- merge(StateMonthMobility, covid.active, by.x = c("sub_region_1", "date"), by.y = c("state", "lag.active.rates"))
mobility.active <- mobility.active %>%
mutate(state = sub_region_1) %>%
select(c(state, date, retail_and_recreation_percent_change_from_baseline, grocery_and_pharmacy_percent_change_from_baseline,
parks_percent_change_from_baseline, transit_stations_percent_change_from_baseline, workplaces_percent_change_from_baseline,
residential_percent_change_from_baseline, active.rates)) %>%
filter(date >= as.Date("2020-04-07"))
covid.death.midwest
covid.death.northeast
covid.death.south
covid.death.west
covid.confirm.midwest
covid.confirm.northeast
covid.confirm.south
covid.confirm.west
covid.test.rate.midwest
covid.test.rate.northeast
covid.test.rate.south
covid.test.rate.west
covid.incident.rate.midwest
covid.incident.rate.northeast
covid.incident.rate.south
covid.incident.rate.west
mobility.r.midwest
mobility.r.northeast
mobility.r.south
mobility.r.west
mobility.gp.midwest
mobility.gp.northeast
mobility.gp.south
mobility.gp.west
mobility.parks.midwest
mobility.parks.northeast
mobility.parks.south
mobility.parks.west
mobility.transit.midwest
mobility.transit.northeast
mobility.transit.south
mobility.transit.west
mobility.work.midwest
mobility.work.northeast
mobility.work.south
mobility.work.west
mobility.res.midwest
mobility.res.northeast
mobility.res.south
mobility.res.west
unemploy.mw
unemploy.ne
unemploy.s
unemploy.w
svi.pov.mw
svi.pov.ne
svi.pov.s
svi.pov.w
svi.uninsured.mw
svi.uninsured.ne
svi.uninsured.s
svi.uninsured.w
svi.mobile.mw
svi.mobile.ne
svi.mobile.s
svi.mobile.w
svi.minority.mw
svi.minority.ne
svi.minority.s
svi.minority.w
svi.disabled.mw
svi.disabled.ne
svi.disabled.s
svi.disabled.w
svi.old.mw
svi.old.ne
svi.old.s
svi.old.w
svi.pci.mw
svi.pci.ne
svi.pci.s
svi.pci.w
save.image("E:/UCSD/2020-2021 Senior/PSYC 201 Project/covid_project/.Rhistory.RData")
